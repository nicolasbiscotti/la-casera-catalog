<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>La Casera - Catálogo de Precios</title>
    <meta
      name="description"
      content="Catálogo de precios de La Casera - Fiambrería y Almacén"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                50: "#fef7ee",
                100: "#fdecd3",
                200: "#fad5a5",
                300: "#f6b86d",
                400: "#f19132",
                500: "#ee7512",
                600: "#df5a08",
                700: "#b94309",
                800: "#93350f",
                900: "#772e10",
                950: "#401506",
              },
              warm: {
                50: "#faf9f7",
                100: "#f3f1ed",
                200: "#e5e1d8",
                300: "#d3ccbe",
                400: "#bdb3a0",
                500: "#ac9d87",
                600: "#9f8d77",
                700: "#847462",
                800: "#6c5f53",
                900: "#594f45",
                950: "#2f2924",
              },
            },
            fontFamily: {
              display: ["Playfair Display", "Georgia", "serif"],
              body: ["Source Sans 3", "system-ui", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      body {
        font-family: "Source Sans 3", system-ui, sans-serif;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "Playfair Display", Georgia, serif;
      }
      .glass {
        background-color: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(12px);
      }
      @keyframes fade-in {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      .animate-fade-in {
        animation: fade-in 0.3s ease-out;
      }
    </style>
  </head>
  <body class="min-h-screen bg-warm-50 text-warm-900">
    <div id="app"></div>
    <script>
      const mockCategories = [
        {
          id: "cat-1",
          name: "Fiambres",
          slug: "fiambres",
          iconName: "meat",
          isActive: true,
          sortOrder: 1,
        },
        {
          id: "cat-2",
          name: "Quesos",
          slug: "quesos",
          iconName: "cheese",
          isActive: true,
          sortOrder: 2,
        },
        {
          id: "cat-3",
          name: "Lácteos",
          slug: "lacteos",
          iconName: "milk",
          isActive: true,
          sortOrder: 3,
        },
        {
          id: "cat-4",
          name: "Almacén",
          slug: "almacen",
          iconName: "store",
          isActive: true,
          sortOrder: 4,
        },
      ];
      const mockBrands = [
        { id: "brand-1", name: "Paladini", isActive: true, sortOrder: 1 },
        { id: "brand-2", name: "Cagnoli", isActive: true, sortOrder: 2 },
        { id: "brand-3", name: "Santa Rosa", isActive: true, sortOrder: 3 },
        { id: "brand-4", name: "Verónica", isActive: true, sortOrder: 4 },
        { id: "brand-5", name: "La Serenísima", isActive: true, sortOrder: 5 },
        { id: "brand-6", name: "Sancor", isActive: true, sortOrder: 6 },
        { id: "brand-7", name: "La Campagnola", isActive: true, sortOrder: 7 },
      ];
      const mockProducts = [
        {
          id: "prod-1",
          name: "Jamón Cocido Natural",
          brandId: "brand-1",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 8500,
              availableWeights: [100, 250, 500, 1000],
            },
          ],
          isAvailable: true,
          tags: ["premium"],
        },
        {
          id: "prod-2",
          name: "Salame Milán",
          brandId: "brand-1",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 12000,
              availableWeights: [100, 250, 500],
            },
          ],
          isAvailable: true,
        },
        {
          id: "prod-3",
          name: "Mortadela con Aceitunas",
          brandId: "brand-1",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 6500,
              availableWeights: [250, 500, 1000],
            },
          ],
          isAvailable: true,
        },
        {
          id: "prod-4",
          name: "Panceta Ahumada",
          brandId: "brand-1",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 9800,
              availableWeights: [100, 250, 500],
            },
          ],
          isAvailable: true,
          tags: ["premium"],
        },
        {
          id: "prod-5",
          name: "Jamón Crudo",
          brandId: "brand-2",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 18000,
              availableWeights: [100, 250, 500],
            },
          ],
          isAvailable: true,
          tags: ["premium", "importado"],
        },
        {
          id: "prod-6",
          name: "Bondiola",
          brandId: "brand-2",
          categoryId: "cat-1",
          prices: [
            {
              type: "weight",
              pricePerKg: 15000,
              availableWeights: [100, 250, 500],
            },
          ],
          isAvailable: true,
        },
        {
          id: "prod-7",
          name: "Queso Sardo",
          brandId: "brand-3",
          categoryId: "cat-2",
          prices: [
            {
              type: "fraction",
              prices: { whole: 28000, half: 15000, quarter: 8000 },
              fractionLabel: "horma",
            },
          ],
          isAvailable: true,
          tags: ["premium"],
        },
        {
          id: "prod-8",
          name: "Queso Cremoso",
          brandId: "brand-3",
          categoryId: "cat-2",
          prices: [
            {
              type: "weight",
              pricePerKg: 7500,
              availableWeights: [250, 500, 1000],
            },
          ],
          isAvailable: true,
        },
        {
          id: "prod-9",
          name: "Provolone",
          brandId: "brand-3",
          categoryId: "cat-2",
          prices: [
            { type: "weight", pricePerKg: 9200, availableWeights: [250, 500] },
          ],
          isAvailable: true,
        },
        {
          id: "prod-10",
          name: "Queso Rallado",
          brandId: "brand-4",
          categoryId: "cat-2",
          prices: [{ type: "unit", price: 2800, unitLabel: "paquete 250g" }],
          isAvailable: true,
        },
        {
          id: "prod-11",
          name: "Queso Port Salut",
          brandId: "brand-4",
          categoryId: "cat-2",
          prices: [
            {
              type: "fraction",
              prices: { whole: 18000, half: 9500, quarter: 5000 },
              fractionLabel: "horma",
            },
          ],
          isAvailable: true,
        },
        {
          id: "prod-12",
          name: "Leche Entera",
          brandId: "brand-5",
          categoryId: "cat-3",
          prices: [{ type: "unit", price: 1200, unitLabel: "litro" }],
          isAvailable: true,
        },
        {
          id: "prod-13",
          name: "Manteca",
          brandId: "brand-5",
          categoryId: "cat-3",
          prices: [{ type: "unit", price: 2500, unitLabel: "pan 200g" }],
          isAvailable: true,
        },
        {
          id: "prod-14",
          name: "Crema de Leche",
          brandId: "brand-5",
          categoryId: "cat-3",
          prices: [{ type: "unit", price: 1800, unitLabel: "200ml" }],
          isAvailable: true,
        },
        {
          id: "prod-15",
          name: "Yogur Firme Vainilla",
          brandId: "brand-6",
          categoryId: "cat-3",
          prices: [{ type: "unit", price: 950, unitLabel: "pote 190g" }],
          isAvailable: true,
        },
        {
          id: "prod-16",
          name: "Dulce de Leche",
          brandId: "brand-6",
          categoryId: "cat-3",
          prices: [{ type: "unit", price: 3200, unitLabel: "pote 400g" }],
          isAvailable: true,
          tags: ["premium"],
        },
        {
          id: "prod-17",
          name: "Aceitunas Verdes",
          brandId: "brand-7",
          categoryId: "cat-4",
          prices: [{ type: "unit", price: 2100, unitLabel: "frasco 220g" }],
          isAvailable: true,
        },
        {
          id: "prod-18",
          name: "Aceitunas Negras",
          brandId: "brand-7",
          categoryId: "cat-4",
          prices: [{ type: "unit", price: 2400, unitLabel: "frasco 220g" }],
          isAvailable: false,
        },
        {
          id: "prod-19",
          name: "Tomates Peritas",
          brandId: "brand-7",
          categoryId: "cat-4",
          prices: [{ type: "unit", price: 1100, unitLabel: "lata 400g" }],
          isAvailable: true,
        },
        {
          id: "prod-20",
          name: "Arvejas",
          brandId: "brand-7",
          categoryId: "cat-4",
          prices: [{ type: "unit", price: 980, unitLabel: "lata 350g" }],
          isAvailable: true,
        },
      ];

      const formatCurrency = (amount) =>
        new Intl.NumberFormat("es-AR", {
          style: "currency",
          currency: "ARS",
          minimumFractionDigits: 0,
          maximumFractionDigits: 0,
        }).format(amount);
      const debounce = (func, wait) => {
        let timeout;
        return (...args) => {
          clearTimeout(timeout);
          timeout = setTimeout(() => func(...args), wait);
        };
      };

      const state = {
        searchQuery: "",
        expandedCategories: new Set(mockCategories.map((c) => c.id)),
        expandedBrands: new Set(mockBrands.map((b) => b.id)),
      };

      const icons = {
        store:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"/><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><path d="M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"/><path d="M2 7h20"/></svg>',
        search:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
        x: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',
        chevronDown:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>',
        chevronRight:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>',
        check:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg>',
        xCircle:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>',
        meat: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15.5 2.5c2 0 3.5 1.5 3.5 3.5 0 3-4 6-8 10s-7 5-10 8c3-3 5-6 8-10s7-7 10-8c-2 0-3.5-1.5-3.5-3.5z"/><circle cx="9" cy="9" r="1"/></svg>',
        cheese:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12h20"/><path d="M2 12 12 2l10 10"/><path d="M2 12v8a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-8"/><circle cx="8" cy="17" r="1"/><circle cx="16" cy="17" r="1"/></svg>',
        milk: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 2h8"/><path d="M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2"/><path d="M7 15h10"/></svg>',
        weight:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><path d="M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z"/></svg>',
        box: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>',
        slice:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3 4 7l4 4"/><path d="M4 7h16"/><path d="m16 21 4-4-4-4"/><path d="M20 17H4"/></svg>',
        whatsapp:
          '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>',
        expandAll:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m7 20 5-5 5 5"/><path d="m7 4 5 5 5-5"/></svg>',
        collapseAll:
          '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m7 15 5-5 5 5"/><path d="m7 9 5 5 5-5"/></svg>',
      };

      const icon = (name, cls = "w-5 h-5") =>
        `<span class="${cls}">${icons[name] || icons.store}</span>`;
      const getCategoryIcon = (iconName) =>
        icon(
          { meat: "meat", cheese: "cheese", milk: "milk", store: "store" }[
            iconName
          ] || "store"
        );
      const searchProducts = (query) => {
        const q = query.toLowerCase().trim();
        if (!q) return [];
        return mockProducts.filter((p) => {
          const brand = mockBrands.find((b) => b.id === p.brandId);
          const cat = mockCategories.find((c) => c.id === p.categoryId);
          return (
            p.name.toLowerCase().includes(q) ||
            brand?.name.toLowerCase().includes(q) ||
            cat?.name.toLowerCase().includes(q) ||
            p.tags?.some((t) => t.toLowerCase().includes(q))
          );
        });
      };

      function renderProductCard(product) {
        const brand = mockBrands.find((b) => b.id === product.brandId);
        const price = product.prices[0];
        let priceHtml = "";
        if (price.type === "unit") {
          priceHtml = `<div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-brand-50 text-brand-700">${icon(
            "box",
            "w-4 h-4"
          )}<span class="font-bold">${formatCurrency(
            price.price
          )}</span><span class="text-xs text-brand-500">/ ${
            price.unitLabel
          }</span></div>`;
        } else if (price.type === "weight") {
          priceHtml = `<div class="space-y-1.5"><div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-brand-50 text-brand-700">${icon(
            "weight",
            "w-4 h-4"
          )}<span class="font-bold">${formatCurrency(
            price.pricePerKg
          )}</span><span class="text-xs text-brand-500">/ kg</span></div>${
            price.availableWeights
              ? `<div class="flex flex-wrap gap-1">${price.availableWeights
                  .map(
                    (w) =>
                      `<span class="text-xs px-2 py-0.5 rounded-full bg-warm-100 text-warm-600">${
                        w >= 1000 ? `${w / 1000}kg` : `${w}g`
                      }: ${formatCurrency(
                        (price.pricePerKg * w) / 1000
                      )}</span>`
                  )
                  .join("")}</div>`
              : ""
          }</div>`;
        } else if (price.type === "fraction") {
          priceHtml = `<div class="space-y-1.5"><div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-brand-50 text-brand-700">${icon(
            "slice",
            "w-4 h-4"
          )}<span class="text-xs text-brand-500">Por ${
            price.fractionLabel
          }</span></div><div class="flex flex-wrap gap-1"><span class="text-xs px-2 py-0.5 rounded-full bg-brand-100 text-brand-700 font-medium">Entera: ${formatCurrency(
            price.prices.whole
          )}</span><span class="text-xs px-2 py-0.5 rounded-full bg-brand-100 text-brand-700 font-medium">1/2: ${formatCurrency(
            price.prices.half
          )}</span><span class="text-xs px-2 py-0.5 rounded-full bg-brand-100 text-brand-700 font-medium">1/4: ${formatCurrency(
            price.prices.quarter
          )}</span></div></div>`;
        }
        return `<div class="product-card bg-gradient-to-br from-white to-warm-50 p-4 rounded-lg border border-warm-100 hover:border-brand-200 hover:shadow-md transition-all animate-fade-in"><div class="flex items-start justify-between gap-3 mb-3"><div class="min-w-0 flex-1"><h4 class="font-semibold text-warm-800 truncate">${
          product.name
        }</h4><p class="text-sm text-warm-500">${brand?.name || ""}</p></div>${
          product.isAvailable
            ? `<span class="flex-shrink-0 inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700">${icon(
                "check",
                "w-3 h-3"
              )}Disponible</span>`
            : `<span class="flex-shrink-0 inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700">${icon(
                "xCircle",
                "w-3 h-3"
              )}Sin stock</span>`
        }</div>${
          product.tags?.length
            ? `<div class="flex flex-wrap gap-1 mb-3">${product.tags
                .map(
                  (tag) =>
                    `<span class="text-xs px-2 py-0.5 rounded-full bg-warm-200 text-warm-700">${tag}</span>`
                )
                .join("")}</div>`
            : ""
        }<div class="mt-auto">${priceHtml}</div></div>`;
      }

      function renderCategoryAccordion(category, brands, products) {
        const categoryProducts = products.filter(
          (p) => p.categoryId === category.id
        );
        if (categoryProducts.length === 0) return "";
        const categoryBrandIds = [
          ...new Set(categoryProducts.map((p) => p.brandId)),
        ];
        const categoryBrands = brands.filter((b) =>
          categoryBrandIds.includes(b.id)
        );
        const isExpanded = state.expandedCategories.has(category.id);
        return `<div class="category-item bg-white rounded-xl border border-warm-200 overflow-hidden hover:border-brand-300 hover:shadow-lg transition-all"><button class="category-header w-full flex items-center justify-between p-4 hover:bg-warm-50 transition-colors" data-category="${
          category.id
        }"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-lg bg-brand-100 flex items-center justify-center text-brand-600">${getCategoryIcon(
          category.iconName
        )}</div><div class="text-left"><h3 class="font-display font-semibold text-warm-800">${
          category.name
        }</h3><p class="text-xs text-warm-500">${
          categoryProducts.length
        } productos</p></div></div><span class="w-5 h-5 text-warm-400 transition-transform ${
          isExpanded ? "rotate-180" : ""
        }">${
          icons.chevronDown
        }</span></button><div class="category-content border-t border-warm-100 ${
          isExpanded ? "" : "hidden"
        }">${categoryBrands
          .map((brand) => {
            const brandProducts = categoryProducts.filter(
              (p) => p.brandId === brand.id
            );
            const isBrandExpanded = state.expandedBrands.has(brand.id);
            return `<div class="border-b border-warm-50 last:border-b-0"><button class="brand-header w-full flex items-center justify-between px-4 py-3 bg-warm-50 hover:bg-warm-100 transition-colors" data-brand="${
              brand.id
            }"><div class="flex items-center gap-2"><span class="w-4 h-4 text-warm-400 transition-transform ${
              isBrandExpanded ? "rotate-90" : ""
            }">${
              icons.chevronRight
            }</span><span class="font-medium text-warm-700">${
              brand.name
            }</span><span class="text-xs text-warm-400">(${
              brandProducts.length
            })</span></div></button><div class="brand-content p-4 ${
              isBrandExpanded ? "" : "hidden"
            }"><div class="grid gap-3 sm:grid-cols-2">${brandProducts
              .map((p) => renderProductCard(p))
              .join("")}</div></div></div>`;
          })
          .join("")}</div></div>`;
      }

      function renderSearchResults(results) {
        if (results.length === 0)
          return `<div class="text-center py-12"><div class="w-16 h-16 mx-auto mb-4 rounded-full bg-warm-200 flex items-center justify-center">${icon(
            "search",
            "w-8 h-8 text-warm-400"
          )}</div><h3 class="font-display text-lg font-semibold text-warm-700 mb-1">Sin resultados</h3><p class="text-warm-500 text-sm">No encontramos productos para "${
            state.searchQuery
          }"</p><button id="clear-search-results" class="mt-4 px-4 py-2 rounded-lg bg-brand-100 text-brand-700 font-medium hover:bg-brand-200 transition-colors">Limpiar búsqueda</button></div>`;
        const grouped = {};
        results.forEach((p) => {
          const cat = mockCategories.find((c) => c.id === p.categoryId);
          const catName = cat?.name || "Otros";
          if (!grouped[catName]) grouped[catName] = [];
          grouped[catName].push(p);
        });
        return `<div class="mb-4"><p class="text-sm text-warm-600">${
          results.length
        } resultado${results.length !== 1 ? "s" : ""} para "<strong>${
          state.searchQuery
        }</strong>"</p></div><div class="space-y-6">${Object.entries(grouped)
          .map(
            ([catName, prods]) =>
              `<div><h3 class="font-display font-semibold text-warm-700 mb-3 flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-brand-500"></span>${catName}</h3><div class="grid gap-3 sm:grid-cols-2">${prods
                .map((p) => renderProductCard(p))
                .join("")}</div></div>`
          )
          .join("")}</div>`;
      }

      function render() {
        const categories = mockCategories
          .filter((c) => c.isActive)
          .sort((a, b) => a.sortOrder - b.sortOrder);
        const brands = mockBrands
          .filter((b) => b.isActive)
          .sort((a, b) => a.sortOrder - b.sortOrder);
        const products = mockProducts;
        const isSearching = state.searchQuery.trim().length > 0;
        let catalogContent = "";
        if (isSearching) {
          catalogContent = renderSearchResults(
            searchProducts(state.searchQuery)
          );
        } else {
          catalogContent = `<div class="flex items-center justify-between mb-4"><p class="text-sm text-warm-600">${
            products.length
          } productos en ${
            categories.length
          } categorías</p><div class="flex gap-2"><button id="expand-all" class="p-2 rounded-lg hover:bg-warm-200 text-warm-600 transition-colors" title="Expandir todo">${icon(
            "expandAll"
          )}</button><button id="collapse-all" class="p-2 rounded-lg hover:bg-warm-200 text-warm-600 transition-colors" title="Colapsar todo">${icon(
            "collapseAll"
          )}</button></div></div><div class="space-y-4">${categories
            .map((cat) => renderCategoryAccordion(cat, brands, products))
            .join("")}</div>`;
        }
        const whatsappUrl = `https://wa.me/5491112345678?text=${encodeURIComponent(
          "Hola! Quiero consultar sobre los productos del catálogo de La Casera."
        )}`;
        document.getElementById(
          "app"
        ).innerHTML = `<div class="min-h-screen flex flex-col"><header class="sticky top-0 z-50 glass border-b border-warm-200"><div class="max-w-4xl mx-auto px-4 sm:px-6 py-3 sm:py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center shadow-lg">${icon(
          "store",
          "w-5 h-5 sm:w-6 sm:h-6 text-white"
        )}</div><div><h1 class="text-xl sm:text-2xl font-bold text-warm-900 font-display">La Casera</h1><p class="text-xs sm:text-sm text-warm-500">Fiambrería y Almacén</p></div></div><div class="text-right"><p class="text-xs text-warm-400">Actualizado</p><p class="text-sm font-medium text-warm-600">${new Date().toLocaleDateString(
          "es-AR"
        )}</p></div></div></div></header><div class="sticky top-[60px] sm:top-[68px] z-40 glass border-b border-warm-200 px-4 sm:px-6 py-3 sm:py-4"><div class="max-w-4xl mx-auto"><div class="relative">${icon(
          "search",
          "absolute left-3 top-1/2 -translate-y-1/2 text-warm-400 w-5 h-5"
        )}<input type="text" id="search-input" placeholder="Buscar productos, marcas..." value="${
          state.searchQuery
        }" class="w-full pl-10 pr-10 py-3 rounded-xl border-2 border-warm-200 bg-white text-warm-800 placeholder:text-warm-400 focus:outline-none focus:border-brand-400 focus:ring-2 focus:ring-brand-100 transition-all"/><button id="clear-search" class="absolute right-3 top-1/2 -translate-y-1/2 text-warm-400 hover:text-warm-600 transition-colors ${
          state.searchQuery ? "" : "hidden"
        }">${icon(
          "x"
        )}</button></div></div></div><main class="flex-1 px-4 sm:px-6 py-6"><div class="max-w-4xl mx-auto">${catalogContent}</div></main><footer class="bg-warm-900 text-warm-100 mt-auto"><div class="max-w-4xl mx-auto px-4 sm:px-6 py-8"><div class="flex flex-col sm:flex-row items-center justify-between gap-6"><div class="text-center sm:text-left"><div class="flex items-center justify-center sm:justify-start gap-2 mb-2"><div class="w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center">${icon(
          "store",
          "w-4 h-4 text-white"
        )}</div><span class="font-display font-bold text-lg">La Casera</span></div><p class="text-warm-400 text-sm">Fiambrería y Almacén</p><p class="text-warm-500 text-xs mt-1">Precios sujetos a cambios sin previo aviso</p></div><div class="flex flex-col items-center sm:items-end gap-3"><a href="${whatsappUrl}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-green-500 text-white font-semibold hover:bg-green-600 transition-colors shadow-lg">${icon(
          "whatsapp"
        )}Consultar por WhatsApp</a><p class="text-warm-500 text-xs">Actualizado: ${new Date().toLocaleDateString(
          "es-AR",
          { day: "numeric", month: "long", year: "numeric" }
        )}</p></div></div></div></footer></div>`;
        attachEventListeners();
      }

      function attachEventListeners() {
        const searchInput = document.getElementById("search-input");
        const clearSearch = document.getElementById("clear-search");
        const debouncedSearch = debounce((value) => {
          state.searchQuery = value;
          render();
        }, 300);
        searchInput?.addEventListener("input", (e) => {
          debouncedSearch(e.target.value);
          clearSearch?.classList.toggle("hidden", !e.target.value);
        });
        searchInput?.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            state.searchQuery = "";
            render();
          }
        });
        clearSearch?.addEventListener("click", () => {
          state.searchQuery = "";
          render();
        });
        document
          .getElementById("clear-search-results")
          ?.addEventListener("click", () => {
            state.searchQuery = "";
            render();
          });
        document.querySelectorAll(".category-header").forEach((header) => {
          header.addEventListener("click", () => {
            const id = header.dataset.category;
            state.expandedCategories.has(id)
              ? state.expandedCategories.delete(id)
              : state.expandedCategories.add(id);
            render();
          });
        });
        document.querySelectorAll(".brand-header").forEach((header) => {
          header.addEventListener("click", () => {
            const id = header.dataset.brand;
            state.expandedBrands.has(id)
              ? state.expandedBrands.delete(id)
              : state.expandedBrands.add(id);
            render();
          });
        });
        document.getElementById("expand-all")?.addEventListener("click", () => {
          mockCategories.forEach((c) => state.expandedCategories.add(c.id));
          mockBrands.forEach((b) => state.expandedBrands.add(b.id));
          render();
        });
        document
          .getElementById("collapse-all")
          ?.addEventListener("click", () => {
            state.expandedCategories.clear();
            state.expandedBrands.clear();
            render();
          });
      }

      document.addEventListener("DOMContentLoaded", () =>
        setTimeout(render, 300)
      );
    </script>
  </body>
</html>
